{% extends "base.html" %}

{% block content %}
<section class="booking-section">
    <h2>Записаться на занятие</h2>

    <div class="pricing-card">
        <h3>Стоимость занятий:</h3>
        <ul>
            <li>Индивидуальное занятие - 1800₽/час</li>
            <li>Индивидуальное занятие (30 минут) - 900₽</li>
            <li>Групповое занятие - 1250₽/час</li>
            <li>Подготовка к ЕГЭ - 2000₽/час</li>
        </ul>
    </div>

    <form class="booking-form" action="/submit_booking" method="post">
        <div class="form-group">
            <label for="name">Ваше имя:</label>
            <input type="text" id="name" name="name" required>
        </div>

        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>

        <div class="form-group">
            <label for="phone">Телефон:</label>
            <input type="tel" id="phone" name="phone" required>
        </div>

        <div class="form-group">
            <label for="lesson_type">Тип занятия:</label>
            <select id="lesson_type" name="lesson_type" required>
                <option value="">Выберите тип занятия</option>
                <option value="individual">Индивидуальное (1 час)</option>
                <option value="individual_30">Индивидуальное (30 минут)</option>
                <option value="group">Групповое</option>
                <option value="ege">Подготовка к ЕГЭ</option>
            </select>
        </div>

        <div class="form-group">
            <label for="message">Дополнительная информация:</label>
            <textarea id="message" name="message" rows="4"></textarea>
        </div>

        <button type="submit">Отправить заявку</button>
    </form>
</section>
<script>
document.querySelector('.booking-form').addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        lesson_type: document.getElementById('lesson_type').value,
        message: document.getElementById('message').value
    };

    try {
        const response = await fetch('http://localhost:8000/api/bookings', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
        });

        if (response.ok) {
            alert('Заявка успешно отправлена!');
            e.target.reset();
        } else {
            const error = await response.json();
            alert(`Ошибка: ${error.detail}`);
        }
    } catch (error) {
        alert('Ошибка сети: ' + error.message);
    }
});
</script>
{% endblock %}